/**
 * Kerangka pembuat soal dan pemeriksa jawaban
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 *
 * @author Muhammad Rifqi Priyo Susanto
 * @publisher Team Tanpa Les Indonesia
 */
var intervalStopwatch,kunciJawaban=[],waktuMulai=0;window.addEventListener("load",(function(){tombolBuat.removeAttribute("disabled"),tombolPeriksa.setAttribute("disabled","disabled")})),tombolBuat.addEventListener("click",(function(){var a=isianJumlah.value;if(isNaN(a)||a<1)alert("Jumlah soal setidaknya satu!");else{"function"==typeof sebelumBuat&&sebelumBuat(),("undefined"==typeof jenisSoal||"isian"!=jenisSoal&&"pilihan"!=jenisSoal)&&(jenisSoal="isian"),kunciJawaban=[];for(var e="",n=0;n<a;n++){var i=buatSoal();if(kunciJawaban.push(i.slice(1,3)),e+='<div class="naskahSoal">',"isian"==jenisSoal)e+="<div>"+i[0]+"</div>",e+='<input type="text" class="isianJawaban" data-nomor="'+n+'">';else if("pilihan"==jenisSoal){var t=i[3];e+='<div class="daftarPilihan" data-nomor="'+n+'">',e+="<div>"+i[0]+"</div>";for(var s=0;s<t.length;s++)e+="<div>",e+='<input type="radio" id="s'+n+"p"+s+'" name="s'+n+'" value="'+t[s]+'">',e+='<label for="s'+n+"p"+s+'">'+t[s]+"</label>",e+="</div>";e+="</div>"}e+="</div>"}hasilSoal.innerHTML=e,hasilPeriksa.innerHTML="",tombolPeriksa.removeAttribute("disabled"),menuParameter.style.display="none",menuSoal.style.display="","isian"==jenisSoal?document.getElementsByClassName("isianJawaban")[0].focus():"pilihan"==jenisSoal&&document.getElementById("s0p0").focus(),waktuMulai=Date.now(),panelStopwatch.innerHTML="",intervalStopwatch=setInterval((function(){var a=Date.now()-waktuMulai,e=(a%6e4/1e3).toFixed(1),n=Math.floor(a/6e4),i=(e<10?"0":"")+e.replaceAll(".",","),t=(n<10?"0":"")+n;panelStopwatch.innerText=t+":"+i}),16)}})),tombolPeriksa.addEventListener("click",(function(){clearInterval(intervalStopwatch);var a="isianJawaban";"pilihan"==jenisSoal&&(a="daftarPilihan");for(var e=document.getElementsByClassName(a),n=0,i=0;i<e.length;i++){var t=e[i],s="";if("isian"==jenisSoal)t.setAttribute("disabled","disabled"),s=t.value.trim();else if("pilihan"==jenisSoal)for(var l=t.getElementsByTagName("input"),o=0;o<l.length;o++)l[o].setAttribute("disabled","disabled"),l[o].checked&&(s=l[o].value);
var r=kunciJawaban[Number(t.dataset.nomor)],d=periksaJawaban(r[1],s);if("isian"==jenisSoal)s.length>0&&d?(t.classList.add("benar"),t.insertAdjacentHTML("afterend",'<div><span class="ikonJawaban">✅</span></div>'),n++):(t.classList.add("salah"),t.insertAdjacentHTML("afterend",'<div><span class="ikonJawaban">❌</span><span class="kunciJawaban">'+r[0]+"</span></div>"));else if("pilihan"==jenisSoal){d?t.classList.add("benar"):t.classList.add("salah");for(l=t.getElementsByTagName("input"),o=0;o<l.length;o++){l[o].setAttribute("disabled","disabled");var u=l[o].parentElement;l[o].checked?d?(u.insertAdjacentHTML("beforeend",'<span class="ikonJawaban">✅</span>'),n++):u.insertAdjacentHTML("beforeend",'<span class="ikonJawaban">❌</span>'):periksaJawaban(r[1],l[o].value)&&u.insertAdjacentHTML("beforeend",'<span class="ikonJawaban">✅</span>')}}}var c=(n/kunciJawaban.length*100).toFixed(2).toString().replaceAll(".",",");hasilPeriksa.innerHTML="Skor: "+n+"/"+kunciJawaban.length+" ("+c+"%)",tombolPeriksa.setAttribute("disabled","disabled"),"function"==typeof setelahPeriksa&&setelahPeriksa(),window.scrollTo(0,hasilPeriksa.offsetTop)})),tombolUlang.addEventListener("click",(function(){clearInterval(intervalStopwatch),menuParameter.style.display="",menuSoal.style.display="none"}));var bilanganBulatAcak=function(a,e){return a-=.49,e+=.49,Math.round(Math.random()*(e-a)+a)};