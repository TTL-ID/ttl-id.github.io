/**
 * Kerangka pembuat soal dan pemeriksa jawaban
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 *
 * @author Muhammad Rifqi Priyo Susanto
 * @publisher Team Tanpa Les Indonesia
 */
var intervalStopwatch,kunciJawaban=[],waktuMulai=0,durasi=0,jumlahSoal=0,skor=0;window.addEventListener("load",(function(){tombolBuat.removeAttribute("disabled"),tombolPeriksa.setAttribute("disabled","disabled")})),tombolBuat.addEventListener("click",(function(){if(jumlahSoal=isianJumlah.value,isNaN(jumlahSoal)||jumlahSoal<1)alert("Jumlah soal setidaknya satu!");else{"function"==typeof sebelumBuat&&sebelumBuat(),("undefined"==typeof jenisSoal||"isian"!=jenisSoal&&"pilihan"!=jenisSoal)&&(jenisSoal="isian"),kunciJawaban=[];for(var a="",e=0;e<jumlahSoal;e++){var i=buatSoal();if(kunciJawaban.push(i.slice(1,3)),a+='<div class="naskahSoal">',"isian"==jenisSoal)a+="<div>"+i[0]+"</div>",a+='<input type="text" class="isianJawaban" data-nomor="'+e+'">';else if("pilihan"==jenisSoal){var n=i[3];a+='<div class="daftarPilihan" data-nomor="'+e+'">',a+="<div>"+i[0]+"</div>";for(var t=0;t<n.length;t++)a+="<div>",a+='<input type="radio" id="s'+e+"p"+t+'" name="s'+e+'" value="'+n[t]+'">',a+='<label for="s'+e+"p"+t+'">'+n[t]+"</label>",a+="</div>";a+="</div>"}a+="</div>"}hasilSoal.innerHTML=a,hasilPeriksa.innerHTML="",tombolPeriksa.removeAttribute("disabled"),menuParameter.style.display="none",menuSoal.style.display="","isian"==jenisSoal?document.getElementsByClassName("isianJawaban")[0].focus():"pilihan"==jenisSoal&&document.getElementById("s0p0").focus(),waktuMulai=Date.now(),panelStopwatch.innerHTML="",intervalStopwatch=setInterval((function(){var a=((durasi=Date.now()-waktuMulai)%6e4/1e3).toFixed(1),e=Math.floor(durasi/6e4),i=(a<10?"0":"")+a.replaceAll(".",","),n=(e<10?"0":"")+e;panelStopwatch.innerText=n+":"+i}),16),skor=0,"string"==typeof idSoal&&gtag("event","quiz_start",{quiz_id:idSoal,quiz_nq:jumlahSoal})}})),tombolPeriksa.addEventListener("click",(function(){clearInterval(intervalStopwatch);var a="isianJawaban";"pilihan"==jenisSoal&&(a="daftarPilihan");for(var e=document.getElementsByClassName(a),i=0,n=0;n<e.length;n++){var t=e[n],s="";if("isian"==jenisSoal)t.setAttribute("disabled","disabled"),
s=t.value.trim();else if("pilihan"==jenisSoal)for(var l=t.getElementsByTagName("input"),o=0;o<l.length;o++)l[o].setAttribute("disabled","disabled"),l[o].checked&&(s=l[o].value);var r=kunciJawaban[Number(t.dataset.nomor)],d=periksaJawaban(r[1],s);if("isian"==jenisSoal)s.length>0&&d?(t.classList.add("benar"),t.insertAdjacentHTML("afterend",'<div><span class="ikonJawaban">✅</span></div>'),i++):(t.classList.add("salah"),t.insertAdjacentHTML("afterend",'<div><span class="ikonJawaban">❌</span><span class="kunciJawaban">'+r[0]+"</span></div>"));else if("pilihan"==jenisSoal){d?t.classList.add("benar"):t.classList.add("salah");for(l=t.getElementsByTagName("input"),o=0;o<l.length;o++){l[o].setAttribute("disabled","disabled");var u=l[o].parentElement;l[o].checked?d?(u.insertAdjacentHTML("beforeend",'<span class="ikonJawaban">✅</span>'),i++):u.insertAdjacentHTML("beforeend",'<span class="ikonJawaban">❌</span>'):periksaJawaban(r[1],l[o].value)&&u.insertAdjacentHTML("beforeend",'<span class="ikonJawaban">✅</span>')}}}var c=(i/kunciJawaban.length*100).toFixed(2).toString().replaceAll(".",",");hasilPeriksa.innerHTML="Skor: "+i+"/"+kunciJawaban.length+" ("+c+"%)",skor=c,tombolPeriksa.setAttribute("disabled","disabled"),"function"==typeof setelahPeriksa&&setelahPeriksa(),"string"==typeof idSoal&&gtag("event","quiz_complete",{quiz_id:idSoal,quiz_nq:jumlahSoal,quiz_score:skor,quiz_time:durasi/1e3}),window.scrollTo(0,hasilPeriksa.offsetTop)})),tombolUlang.addEventListener("click",(function(){clearInterval(intervalStopwatch),menuParameter.style.display="",menuSoal.style.display="none"}));var bilanganBulatAcak=function(a,e){return a-=.49,e+=.49,Math.round(Math.random()*(e-a)+a)};window.dataLayer=window.dataLayer||[];var gtag=function(){dataLayer.push(arguments)};gtag("js",new Date),gtag("config","G-GK42GYSVLY");